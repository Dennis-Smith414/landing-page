(()=>{var Jn=Object.create;var zt=Object.defineProperty;var Kn=Object.getOwnPropertyDescriptor;var Xn=Object.getOwnPropertyNames;var Vn=Object.getPrototypeOf,Qn=Object.prototype.hasOwnProperty;var Gt=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var Zn=(n,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let l of Xn(t))!Qn.call(n,l)&&l!==r&&zt(n,l,{get:()=>t[l],enumerable:!(a=Kn(t,l))||a.enumerable});return n};var er=(n,t,r)=>(r=n!=null?Jn(Vn(n)):{},Zn(t||!n||!n.__esModule?zt(r,"default",{value:n,enumerable:!0}):r,n));var st=Gt((it,at)=>{(function(n,t){typeof it=="object"&&typeof at<"u"?at.exports=t():typeof define=="function"&&define.amd?define(t):(n=typeof globalThis<"u"?globalThis:n||self,n.DOMPurify=t())})(it,function(){"use strict";function n(c){"@babel/helpers - typeof";return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},n(c)}function t(c,f){return t=Object.setPrototypeOf||function(E,D){return E.__proto__=D,E},t(c,f)}function r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function a(c,f,g){return r()?a=Reflect.construct:a=function(D,G,j){var q=[null];q.push.apply(q,G);var le=Function.bind.apply(D,q),ce=new le;return j&&t(ce,j.prototype),ce},a.apply(null,arguments)}function l(c){return s(c)||p(c)||o(c)||y()}function s(c){if(Array.isArray(c))return h(c)}function p(c){if(typeof Symbol<"u"&&c[Symbol.iterator]!=null||c["@@iterator"]!=null)return Array.from(c)}function o(c,f){if(c){if(typeof c=="string")return h(c,f);var g=Object.prototype.toString.call(c).slice(8,-1);if(g==="Object"&&c.constructor&&(g=c.constructor.name),g==="Map"||g==="Set")return Array.from(c);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return h(c,f)}}function h(c,f){(f==null||f>c.length)&&(f=c.length);for(var g=0,E=new Array(f);g<f;g++)E[g]=c[g];return E}function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var A=Object.hasOwnProperty,T=Object.setPrototypeOf,O=Object.isFrozen,m=Object.getPrototypeOf,S=Object.getOwnPropertyDescriptor,w=Object.freeze,L=Object.seal,ee=Object.create,mt=typeof Reflect<"u"&&Reflect,he=mt.apply,Ne=mt.construct;he||(he=function(f,g,E){return f.apply(g,E)}),w||(w=function(f){return f}),L||(L=function(f){return f}),Ne||(Ne=function(f,g){return a(f,l(g))});var sn=H(Array.prototype.forEach),dt=H(Array.prototype.pop),se=H(Array.prototype.push),ge=H(String.prototype.toLowerCase),Ce=H(String.prototype.toString),ln=H(String.prototype.match),W=H(String.prototype.replace),cn=H(String.prototype.indexOf),un=H(String.prototype.trim),F=H(RegExp.prototype.test),Me=fn(TypeError);function H(c){return function(f){for(var g=arguments.length,E=new Array(g>1?g-1:0),D=1;D<g;D++)E[D-1]=arguments[D];return he(c,f,E)}}function fn(c){return function(){for(var f=arguments.length,g=new Array(f),E=0;E<f;E++)g[E]=arguments[E];return Ne(c,g)}}function b(c,f,g){g=g||ge,T&&T(c,null);for(var E=f.length;E--;){var D=f[E];if(typeof D=="string"){var G=g(D);G!==D&&(O(f)||(f[E]=G),D=G)}c[D]=!0}return c}function V(c){var f=ee(null),g;for(g in c)he(A,c,[g])===!0&&(f[g]=c[g]);return f}function ve(c,f){for(;c!==null;){var g=S(c,f);if(g){if(g.get)return H(g.get);if(typeof g.value=="function")return H(g.value)}c=m(c)}function E(D){return console.warn("fallback value for",D),null}return E}var ht=w(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ke=w(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Pe=w(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pn=w(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fe=w(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),mn=w(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),gt=w(["#text"]),vt=w(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ue=w(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),yt=w(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ye=w(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),dn=L(/\{\{[\w\W]*|[\w\W]*\}\}/gm),hn=L(/<%[\w\W]*|[\w\W]*%>/gm),gn=L(/\${[\w\W]*}/gm),vn=L(/^data-[\-\w.\u00B7-\uFFFF]/),yn=L(/^aria-[\-\w]+$/),bn=L(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wn=L(/^(?:\w+script|data):/i),En=L(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Tn=L(/^html$/i),An=function(){return typeof window>"u"?null:window},Sn=function(f,g){if(n(f)!=="object"||typeof f.createPolicy!="function")return null;var E=null,D="data-tt-policy-suffix";g.currentScript&&g.currentScript.hasAttribute(D)&&(E=g.currentScript.getAttribute(D));var G="dompurify"+(E?"#"+E:"");try{return f.createPolicy(G,{createHTML:function(q){return q},createScriptURL:function(q){return q}})}catch{return console.warn("TrustedTypes policy "+G+" could not be created."),null}};function bt(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:An(),f=function(e){return bt(e)};if(f.version="2.4.3",f.removed=[],!c||!c.document||c.document.nodeType!==9)return f.isSupported=!1,f;var g=c.document,E=c.document,D=c.DocumentFragment,G=c.HTMLTemplateElement,j=c.Node,q=c.Element,le=c.NodeFilter,ce=c.NamedNodeMap,xn=ce===void 0?c.NamedNodeMap||c.MozNamedAttrMap:ce,On=c.HTMLFormElement,Dn=c.DOMParser,be=c.trustedTypes,we=q.prototype,In=ve(we,"cloneNode"),Ln=ve(we,"nextSibling"),Rn=ve(we,"childNodes"),He=ve(we,"parentNode");if(typeof G=="function"){var Be=E.createElement("template");Be.content&&Be.content.ownerDocument&&(E=Be.content.ownerDocument)}var z=Sn(be,g),We=z?z.createHTML(""):"",Ee=E,ze=Ee.implementation,Nn=Ee.createNodeIterator,Cn=Ee.createDocumentFragment,Mn=Ee.getElementsByTagName,kn=g.importNode,wt={};try{wt=V(E).documentMode?E.documentMode:{}}catch{}var $={};f.isSupported=typeof He=="function"&&ze&&typeof ze.createHTMLDocument<"u"&&wt!==9;var Ge=dn,qe=hn,$e=gn,Pn=vn,Fn=yn,Un=wn,Et=En,je=bn,R=null,Tt=b({},[].concat(l(ht),l(ke),l(Pe),l(Fe),l(gt))),M=null,At=b({},[].concat(l(vt),l(Ue),l(yt),l(ye))),I=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ue=null,Ye=null,St=!0,Je=!0,_t=!1,te=!1,Q=!1,Ke=!1,Xe=!1,ne=!1,Te=!1,Ae=!1,xt=!0,Ot=!1,Hn="user-content-",Ve=!0,fe=!1,re={},oe=null,Dt=b({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),It=null,Lt=b({},["audio","video","img","source","image","track"]),Qe=null,Rt=b({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Se="http://www.w3.org/1998/Math/MathML",_e="http://www.w3.org/2000/svg",Y="http://www.w3.org/1999/xhtml",ie=Y,Ze=!1,et=null,Bn=b({},[Se,_e,Y],Ce),Z,Wn=["application/xhtml+xml","text/html"],zn="text/html",N,ae=null,Gn=E.createElement("form"),Nt=function(e){return e instanceof RegExp||e instanceof Function},tt=function(e){ae&&ae===e||((!e||n(e)!=="object")&&(e={}),e=V(e),Z=Wn.indexOf(e.PARSER_MEDIA_TYPE)===-1?Z=zn:Z=e.PARSER_MEDIA_TYPE,N=Z==="application/xhtml+xml"?Ce:ge,R="ALLOWED_TAGS"in e?b({},e.ALLOWED_TAGS,N):Tt,M="ALLOWED_ATTR"in e?b({},e.ALLOWED_ATTR,N):At,et="ALLOWED_NAMESPACES"in e?b({},e.ALLOWED_NAMESPACES,Ce):Bn,Qe="ADD_URI_SAFE_ATTR"in e?b(V(Rt),e.ADD_URI_SAFE_ATTR,N):Rt,It="ADD_DATA_URI_TAGS"in e?b(V(Lt),e.ADD_DATA_URI_TAGS,N):Lt,oe="FORBID_CONTENTS"in e?b({},e.FORBID_CONTENTS,N):Dt,ue="FORBID_TAGS"in e?b({},e.FORBID_TAGS,N):{},Ye="FORBID_ATTR"in e?b({},e.FORBID_ATTR,N):{},re="USE_PROFILES"in e?e.USE_PROFILES:!1,St=e.ALLOW_ARIA_ATTR!==!1,Je=e.ALLOW_DATA_ATTR!==!1,_t=e.ALLOW_UNKNOWN_PROTOCOLS||!1,te=e.SAFE_FOR_TEMPLATES||!1,Q=e.WHOLE_DOCUMENT||!1,ne=e.RETURN_DOM||!1,Te=e.RETURN_DOM_FRAGMENT||!1,Ae=e.RETURN_TRUSTED_TYPE||!1,Xe=e.FORCE_BODY||!1,xt=e.SANITIZE_DOM!==!1,Ot=e.SANITIZE_NAMED_PROPS||!1,Ve=e.KEEP_CONTENT!==!1,fe=e.IN_PLACE||!1,je=e.ALLOWED_URI_REGEXP||je,ie=e.NAMESPACE||Y,e.CUSTOM_ELEMENT_HANDLING&&Nt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(I.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Nt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(I.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(I.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),te&&(Je=!1),Te&&(ne=!0),re&&(R=b({},l(gt)),M=[],re.html===!0&&(b(R,ht),b(M,vt)),re.svg===!0&&(b(R,ke),b(M,Ue),b(M,ye)),re.svgFilters===!0&&(b(R,Pe),b(M,Ue),b(M,ye)),re.mathMl===!0&&(b(R,Fe),b(M,yt),b(M,ye))),e.ADD_TAGS&&(R===Tt&&(R=V(R)),b(R,e.ADD_TAGS,N)),e.ADD_ATTR&&(M===At&&(M=V(M)),b(M,e.ADD_ATTR,N)),e.ADD_URI_SAFE_ATTR&&b(Qe,e.ADD_URI_SAFE_ATTR,N),e.FORBID_CONTENTS&&(oe===Dt&&(oe=V(oe)),b(oe,e.FORBID_CONTENTS,N)),Ve&&(R["#text"]=!0),Q&&b(R,["html","head","body"]),R.table&&(b(R,["tbody"]),delete ue.tbody),w&&w(e),ae=e)},Ct=b({},["mi","mo","mn","ms","mtext"]),Mt=b({},["foreignobject","desc","title","annotation-xml"]),qn=b({},["title","style","font","a","script"]),xe=b({},ke);b(xe,Pe),b(xe,pn);var nt=b({},Fe);b(nt,mn);var $n=function(e){var i=He(e);(!i||!i.tagName)&&(i={namespaceURI:ie,tagName:"template"});var u=ge(e.tagName),_=ge(i.tagName);return et[e.namespaceURI]?e.namespaceURI===_e?i.namespaceURI===Y?u==="svg":i.namespaceURI===Se?u==="svg"&&(_==="annotation-xml"||Ct[_]):!!xe[u]:e.namespaceURI===Se?i.namespaceURI===Y?u==="math":i.namespaceURI===_e?u==="math"&&Mt[_]:!!nt[u]:e.namespaceURI===Y?i.namespaceURI===_e&&!Mt[_]||i.namespaceURI===Se&&!Ct[_]?!1:!nt[u]&&(qn[u]||!xe[u]):!!(Z==="application/xhtml+xml"&&et[e.namespaceURI]):!1},J=function(e){se(f.removed,{element:e});try{e.parentNode.removeChild(e)}catch{try{e.outerHTML=We}catch{e.remove()}}},rt=function(e,i){try{se(f.removed,{attribute:i.getAttributeNode(e),from:i})}catch{se(f.removed,{attribute:null,from:i})}if(i.removeAttribute(e),e==="is"&&!M[e])if(ne||Te)try{J(i)}catch{}else try{i.setAttribute(e,"")}catch{}},kt=function(e){var i,u;if(Xe)e="<remove></remove>"+e;else{var _=ln(e,/^[\r\n\t ]+/);u=_&&_[0]}Z==="application/xhtml+xml"&&ie===Y&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var U=z?z.createHTML(e):e;if(ie===Y)try{i=new Dn().parseFromString(U,Z)}catch{}if(!i||!i.documentElement){i=ze.createDocument(ie,"template",null);try{i.documentElement.innerHTML=Ze?We:U}catch{}}var P=i.body||i.documentElement;return e&&u&&P.insertBefore(E.createTextNode(u),P.childNodes[0]||null),ie===Y?Mn.call(i,Q?"html":"body")[0]:Q?i.documentElement:P},Pt=function(e){return Nn.call(e.ownerDocument||e,e,le.SHOW_ELEMENT|le.SHOW_COMMENT|le.SHOW_TEXT,null,!1)},jn=function(e){return e instanceof On&&(typeof e.nodeName!="string"||typeof e.textContent!="string"||typeof e.removeChild!="function"||!(e.attributes instanceof xn)||typeof e.removeAttribute!="function"||typeof e.setAttribute!="function"||typeof e.namespaceURI!="string"||typeof e.insertBefore!="function"||typeof e.hasChildNodes!="function")},pe=function(e){return n(j)==="object"?e instanceof j:e&&n(e)==="object"&&typeof e.nodeType=="number"&&typeof e.nodeName=="string"},K=function(e,i,u){$[e]&&sn($[e],function(_){_.call(f,i,u,ae)})},Ft=function(e){var i;if(K("beforeSanitizeElements",e,null),jn(e)||F(/[\u0080-\uFFFF]/,e.nodeName))return J(e),!0;var u=N(e.nodeName);if(K("uponSanitizeElement",e,{tagName:u,allowedTags:R}),e.hasChildNodes()&&!pe(e.firstElementChild)&&(!pe(e.content)||!pe(e.content.firstElementChild))&&F(/<[/\w]/g,e.innerHTML)&&F(/<[/\w]/g,e.textContent)||u==="select"&&F(/<template/i,e.innerHTML))return J(e),!0;if(!R[u]||ue[u]){if(!ue[u]&&Ht(u)&&(I.tagNameCheck instanceof RegExp&&F(I.tagNameCheck,u)||I.tagNameCheck instanceof Function&&I.tagNameCheck(u)))return!1;if(Ve&&!oe[u]){var _=He(e)||e.parentNode,U=Rn(e)||e.childNodes;if(U&&_)for(var P=U.length,k=P-1;k>=0;--k)_.insertBefore(In(U[k],!0),Ln(e))}return J(e),!0}return e instanceof q&&!$n(e)||(u==="noscript"||u==="noembed")&&F(/<\/no(script|embed)/i,e.innerHTML)?(J(e),!0):(te&&e.nodeType===3&&(i=e.textContent,i=W(i,Ge," "),i=W(i,qe," "),i=W(i,$e," "),e.textContent!==i&&(se(f.removed,{element:e.cloneNode()}),e.textContent=i)),K("afterSanitizeElements",e,null),!1)},Ut=function(e,i,u){if(xt&&(i==="id"||i==="name")&&(u in E||u in Gn))return!1;if(!(Je&&!Ye[i]&&F(Pn,i))){if(!(St&&F(Fn,i))){if(!M[i]||Ye[i]){if(!(Ht(e)&&(I.tagNameCheck instanceof RegExp&&F(I.tagNameCheck,e)||I.tagNameCheck instanceof Function&&I.tagNameCheck(e))&&(I.attributeNameCheck instanceof RegExp&&F(I.attributeNameCheck,i)||I.attributeNameCheck instanceof Function&&I.attributeNameCheck(i))||i==="is"&&I.allowCustomizedBuiltInElements&&(I.tagNameCheck instanceof RegExp&&F(I.tagNameCheck,u)||I.tagNameCheck instanceof Function&&I.tagNameCheck(u))))return!1}else if(!Qe[i]){if(!F(je,W(u,Et,""))){if(!((i==="src"||i==="xlink:href"||i==="href")&&e!=="script"&&cn(u,"data:")===0&&It[e])){if(!(_t&&!F(Un,W(u,Et,"")))){if(u)return!1}}}}}}return!0},Ht=function(e){return e.indexOf("-")>0},Bt=function(e){var i,u,_,U;K("beforeSanitizeAttributes",e,null);var P=e.attributes;if(P){var k={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M};for(U=P.length;U--;){i=P[U];var Oe=i,C=Oe.name,ot=Oe.namespaceURI;if(u=C==="value"?i.value:un(i.value),_=N(C),k.attrName=_,k.attrValue=u,k.keepAttr=!0,k.forceKeepAttr=void 0,K("uponSanitizeAttribute",e,k),u=k.attrValue,!k.forceKeepAttr&&(rt(C,e),!!k.keepAttr)){if(F(/\/>/i,u)){rt(C,e);continue}te&&(u=W(u,Ge," "),u=W(u,qe," "),u=W(u,$e," "));var Wt=N(e.nodeName);if(Ut(Wt,_,u)){if(Ot&&(_==="id"||_==="name")&&(rt(C,e),u=Hn+u),z&&n(be)==="object"&&typeof be.getAttributeType=="function"&&!ot)switch(be.getAttributeType(Wt,_)){case"TrustedHTML":u=z.createHTML(u);break;case"TrustedScriptURL":u=z.createScriptURL(u);break}try{ot?e.setAttributeNS(ot,C,u):e.setAttribute(C,u),dt(f.removed)}catch{}}}}K("afterSanitizeAttributes",e,null)}},Yn=function d(e){var i,u=Pt(e);for(K("beforeSanitizeShadowDOM",e,null);i=u.nextNode();)K("uponSanitizeShadowNode",i,null),!Ft(i)&&(i.content instanceof D&&d(i.content),Bt(i));K("afterSanitizeShadowDOM",e,null)};return f.sanitize=function(d){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i,u,_,U,P;if(Ze=!d,Ze&&(d="<!-->"),typeof d!="string"&&!pe(d)){if(typeof d.toString!="function")throw Me("toString is not a function");if(d=d.toString(),typeof d!="string")throw Me("dirty is not a string, aborting")}if(!f.isSupported){if(n(c.toStaticHTML)==="object"||typeof c.toStaticHTML=="function"){if(typeof d=="string")return c.toStaticHTML(d);if(pe(d))return c.toStaticHTML(d.outerHTML)}return d}if(Ke||tt(e),f.removed=[],typeof d=="string"&&(fe=!1),fe){if(d.nodeName){var k=N(d.nodeName);if(!R[k]||ue[k])throw Me("root node is forbidden and cannot be sanitized in-place")}}else if(d instanceof j)i=kt("<!---->"),u=i.ownerDocument.importNode(d,!0),u.nodeType===1&&u.nodeName==="BODY"||u.nodeName==="HTML"?i=u:i.appendChild(u);else{if(!ne&&!te&&!Q&&d.indexOf("<")===-1)return z&&Ae?z.createHTML(d):d;if(i=kt(d),!i)return ne?null:Ae?We:""}i&&Xe&&J(i.firstChild);for(var Oe=Pt(fe?d:i);_=Oe.nextNode();)_.nodeType===3&&_===U||Ft(_)||(_.content instanceof D&&Yn(_.content),Bt(_),U=_);if(U=null,fe)return d;if(ne){if(Te)for(P=Cn.call(i.ownerDocument);i.firstChild;)P.appendChild(i.firstChild);else P=i;return M.shadowroot&&(P=kn.call(g,P,!0)),P}var C=Q?i.outerHTML:i.innerHTML;return Q&&R["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&F(Tn,i.ownerDocument.doctype.name)&&(C="<!DOCTYPE "+i.ownerDocument.doctype.name+`>
`+C),te&&(C=W(C,Ge," "),C=W(C,qe," "),C=W(C,$e," ")),z&&Ae?z.createHTML(C):C},f.setConfig=function(d){tt(d),Ke=!0},f.clearConfig=function(){ae=null,Ke=!1},f.isValidAttribute=function(d,e,i){ae||tt({});var u=N(d),_=N(e);return Ut(u,_,i)},f.addHook=function(d,e){typeof e=="function"&&($[d]=$[d]||[],se($[d],e))},f.removeHook=function(d){if($[d])return dt($[d])},f.removeHooks=function(d){$[d]&&($[d]=[])},f.removeAllHooks=function(){$={}},f}var _n=bt();return _n})});var $t=Gt((Lr,qt)=>{qt.exports=window.DOMPurify||(window.DOMPurify=st().default||st())});var me=er($t(),1);var X={maptiles:"https://tiles.search.brave.com/maptiles",premium:"https://account.brave.com/?intent=checkout&product=search",production:!0,watch_mode:!1};var lt=(()=>{if(typeof window>"u")return{};let n=window?.document?.getElementById("js-shared")?.getAttribute("data");if(!n)return{};try{return JSON.parse(n)}catch{return{}}})(),Cr=X.production?()=>{}:console.log,ct=X.production?()=>{}:console.error;function ut(){if(typeof window<"u"&&typeof document<"u"&&document.cookie){let n=document.cookie.split(";").map(r=>r.trim()).map(r=>r.split("=")),t={};for(let r=0;r<n.length;r+=1){let[a,l]=n[r];t[a]=l}return t}return{}}function tr(){try{return document.documentElement.lang.slice(0,2)}catch{return"en"}}function nr(){try{let n=document.getElementById("js-ask-location");if(!n)return;let t=JSON.parse(n.getAttribute("data"));return`${t.lat}x${t.long}`}catch{return}}function rr(){return new URL(window.location.href).searchParams.get("geoloc")}function or(){let n=rr();if(n)return n;let t=ut();return t.geoloc?t.geoloc:nr()}function jt({withGeoloc:n=!0}={}){let t=new URL(window.location.href),{reproducible_parameters:r={}}=lt;for(let[s,p]of Object.entries(r))t.searchParams.has(s)===!1&&p!==null&&t.searchParams.set(s,p);let a=ut();for(let s of["spellcheck","safesearch","country","external"])t.searchParams.has(s)===!1&&a[s]!==void 0&&t.searchParams.set(s,a[s]);let l=tr();if(t.searchParams.has("search_lang")===!1&&t.searchParams.set("search_lang",l),n){if(t.searchParams.has("geoloc")===!1){let s=or();s&&t.searchParams.set("geoloc",s)}}else t.searchParams.delete("geoloc");return t.searchParams.set("bypass_cache","1"),t.href}function De(){return ut().olnt==="1"}function ir(n,t){return fetch(n,{credentials:X.production?"omit":"same-origin",method:"POST",mode:"no-cors",body:JSON.stringify(t),referrerPolicy:"no-referrer",headers:{"Referrer-Policy":"no-referrer"}})}function Yt(n){return ir("/api/feedback",n)}function Jt(){return lt.is_ios===!0&&sr()}function Kt(){return!!lt.is_mobile}function Xt(){if(typeof window>"u")return!1;let{performance:n={}}=window;if(n?.getEntriesByType("navigation")[0]?.type==="reload")return!0;let t=n?.navigation?.type;return t!==void 0&&t===n?.navigation?.TYPE_RELOAD}function ar(){return JSON.parse(localStorage.getItem("app.indepScore"))||[]}function Vt(){let n=ar(),t=0,r=0,a=20,l=200;if(n&&n.length>0)for(let s=n.length-1;s>=0&&r<l;s-=1){let[p,o]=n[s];t+=p,r+=o}return r<a?{available:!1,value:null}:{available:!0,value:parseInt(t/r*100)}}function sr(){return!!window?.brave?.getCanSetDefaultSearchProvider}me.default.addHook("afterSanitizeAttributes",function(n){n.tagName==="A"&&(n.setAttribute("target",De()?"_blank":"_self"),n.setAttribute("rel","noopener"))});X.production||(me.default.addHook("uponSanitizeElement",function(n,t){t.tagName!=="body"&&!t.allowedTags[t.tagName]&&ct(`DOMPurify removed ${t.tagName} tag: ${n.outerHTML&&n.outerHTML.substring(0,200)}`)}),me.default.addHook("uponSanitizeAttribute",function(n,t){!t.attrName.startsWith("data-")&&!((t.attrName==="rel"||t.attrName==="target")&&n.tagName.toLowerCase()=="a")&&!t.allowedAttributes[t.attrName]&&ct(`DOMPurify removed ${t.attrName} attr: ${n.outerHTML&&n.outerHTML.substring(0,200)}`)}));var lr=/^(?:(?:https?):\/\/|\/)/i;function cr(n,{addClassAttribute:t}={}){let r={ALLOWED_TAGS:n,ALLOWED_ATTR:[],ALLOWED_URI_REGEXP:lr,KEEP_CONTENT:!0,RETURN_TRUSTED_TYPE:!0};return n.includes("a")&&(r.ALLOWED_ATTR.push("href"),t=!0),n.includes("img")&&r.ALLOWED_ATTR.push("src"),t&&r.ALLOWED_ATTR.push("class"),r}var ur=cr(["b","blockquote","br","code","del","em","h1","h2","h3","h4","h5","h6","hr","i","kbd","li","ol","p","pre","s","span","strong","sup","table","tbody","td","th","thead","tr","ul"],{addClassAttribute:!0});function Ie(n,t){return me.default.sanitize(n,t===void 0?ur:t)}var v=X.production?()=>{}:console.log.bind(console,"[gmix]");function fr(n){if(!n)return n;let t=n.indexOf("#:~:text=");return t===-1?n:n.slice(0,t)}function pr(n,t){let r=t.hostname;if(t.pathname.startsWith("/amp/")&&(r==="bing.com"||r.endsWith(".bing.com")||r==="google.com"||r.endsWith(".google.com"))){let a=t.pathname.slice(5),l="http";return a.startsWith("s/")&&(a=a.slice(2),l="https"),`${l}://${a}`}if(r==="cdn.ampproject.org"||r.endsWith(".cdn.ampproject.org")||r==="bing-amp.com"||r.endsWith(".bing-amp.com")){let a=t.pathname;if(a.startsWith("/c/")){let l="http";return a=a.slice(3),a.startsWith("s/")&&(a=a.slice(2),l="https"),`${l}://${a}`}}return t.searchParams.has("amp")?(t.searchParams.delete("amp"),t.href):n}function de(n){if(n&&typeof n=="string")try{let t=new URL(n,"https://www.google.com/search");return t.searchParams.has("ref_src")&&t.searchParams.delete("ref_src"),pr(t.href,t)}catch{return}}var Qt={USE_PROFILES:{html:!0},ADD_TAGS:["g-link","g-img","g-scrolling-carousel","g-inner-card"],ADD_ATTR:["aria-label","aria-level","role"]};function Zt(n){let t={query:{container:"#taw",attributes:{altered:{item:"a.gL9Hy",type:"single",post:o=>o.textContent},original:{item:"a.spell_orig",type:"single",post:o=>o.textContent}}},web:{container:"#main div.g, #main div.mnr-c.uUPGi, #main div.MjjYud",attributes:{title:{item:'div.yuRUbf > a > h3, div.DOqJne > g-link > a > h3, a div[role="heading"]',type:"single",post:o=>o.textContent},url:{item:'div.yuRUbf > a, div.DOqJne > g-link > a, div.KJDcUb > a, a[role="presentation"]',type:"single",post:o=>de(fr(o.href))},age:{item:"div.IsZvec > div > span > span.f, div.IsZvec span.f, div.LZ8hH span",type:"single",post:o=>o?.textContent?.trim()||void 0},description:{item:"span.aCOpRe > span, div.MUxGbd.yDYNvb",type:"multiple",post:o=>o.map(h=>{for(let y of h.querySelectorAll("[class],[id]"))y.removeAttribute("id"),y.removeAttribute("class");return h.innerHTML}).join(" ").replace(/<b>/g,"<strong>").replace(/<\/b>/g,"</strong>").replace(/<em>/g,"<strong>").replace(/<\/em>/g,"</strong>")},deepLinks:{item:".HiHjCd > a",type:"multiple",post:o=>o.map(h=>({href:h.href,title:h.textContent}))},cluster:{item:"table td",type:"multiple",post:o=>o.map(h=>({url:de(h?.querySelector("a[href]")?.href),title:h?.querySelector("a[href]")?.textContent,description:h?.querySelector("div.s")?.textContent})).filter(h=>h.url&&h.title&&h.description&&!h.url.includes("/search?q="))}}},places2:{container:"#lu_map",attributes:{title:{post:o=>o.title}}},"img-p":{container:"#iur",attributes:{image:{item:'g-img > img[id^="dimg_"][title]',type:"multiple",post:o=>o.map(h=>({title:h.title}))}}},"video-p":{container:"#main div.PhiYYd.QBl4oe, #main div.knowledge-block__video-nav-block, #main a.h8wnqb",attributes:{title:{item:'div.tHQl7d > div, img[alt]:not([alt=""])',type:"single",post:o=>o.textContent||o.alt},url:{post:o=>de(o.href||o.querySelector("div.twQ0Be > a[href]")?.href)},len:{item:"div.J1mWY",type:"single",post:o=>o.textContent}}},"videos-p":{container:"#main div.o0igqc div.mLmaBd",attributes:{title:{item:"div.p5AXld",type:"single",post:o=>o.textContent},url:{item:"a[href]",type:"single",post:o=>de(o.href)}}},"top-stories":{container:"#search g-scrolling-carousel div.fhQnRd g-inner-card",attributes:{title:{item:'div.mCBkyc[role="heading"]',type:"single",post:o=>o.textContent},url:{item:"a[href]",type:"single",post:o=>de(o.href)},age:{item:"p.S1FAPd > span",type:"single",post:o=>o?.textContent?.trim()||void 0}}}};t.featured={container:'#main div[class="V3FYCf"]',attributes:{title:{...t.web.attributes.title},url:{...t.web.attributes.url},description:{item:'span.ILfuVd > span, div[data-attrid] > div[data-attrid][role="heading"], div[data-tts="answers"][data-tts-text]',type:"single",post:o=>o.hasAttribute("data-tts-text")?o.getAttribute("data-tts-text"):o.hasAttribute("data-attrid")?o.textContent:t.web.attributes.description.post([o])},property:{item:'div[aria-level="2"][role="heading"] > span',type:"multiple",post:o=>o.map(h=>h.textContent)},pasf:{item:'a[href*="/search?"][title]',type:"multiple",post:o=>o.map(h=>({title:h.title,response:h?.querySelector(`div[title="${h.title}"]`)?.textContent}))}}};let r=Date.now(),l=new window.DOMParser().parseFromString(n,"text/html"),s=Date.now();v("parsing time",s-r,l);let p={};for(let[o,{container:h,attributes:y}]of Object.entries(t)){let A=[];for(let T of l.querySelectorAll(h)){let O={};for(let[m,{item:S,type:w,post:L}]of Object.entries(y))if(!S)O[m]=L(T);else if(w==="single"){let ee=T.querySelector(S);ee!==null&&(O[m]=L(ee))}else w==="multiple"&&(O[m]=L([...T.querySelectorAll(S)]));Object.values(O).some(m=>Array.isArray(m)?m.length!==0:typeof m=="object"?Object.keys(m).length!==0:!!m)&&A.push(O)}A.length!==0&&(p[o]=A)}if(p.web){p.web=p.web.filter(({url:y})=>y&&(y.startsWith("http://")||y.startsWith("https://"))&&!y.includes("/aclk?")&&!y.includes("utm_source=advertising")&&!y.includes("utm_medium=paidsearch")&&!y.includes("utm_source=google")),p.web?.[0]?.url===p.web?.[1]?.url&&!p.web?.[0]?.description&&p.web.splice(0,1);let o=new Set,h=[];for(let y of p.web)o.has(y.url)||(o.add(y.url),h.push(y));p.web=h}return p}var mr=7,{search:Le,score:Re,favicon_token:dr}=JSON.parse(document.getElementById("js-gmix").getAttribute("data"));function nn(n){n.includes(":/")||(n=`https://${n}`);let t=new URL(n);t.hash="";let r=t.hostname;return r.startsWith("www.")&&(r=r.slice(4)),t.hostname=r,t}async function hr(n){let t=[];for(let l of n)l.node||t.push(new URL(l.url).hostname);let a=await(await fetch("/api/favicons",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({hostnames:t,token:dr})})).json();for(let l=0;l<a.length;l+=1){let s=n[l];s.node||(s.favicon=a[l])}}function gr(n,t){let r=[],a=[];for(let s=0;s<t.web.length;s+=1)t.web[s].source="backup",t.web[s].pos=s,t.web[s].normalizedUrl=nn(t.web[s].url);let l=0;for(let s of t.web){let p=n.find(({normalizedUrl:o})=>o.href===s.normalizedUrl.href);s.isInBoth=p!==void 0,s.isInBoth&&(s.originalResult=p,s.node=p.node,p.isInBoth=!0,l+=1)}if(l!==0&&a.push("results-in-common"),t.web.some(({isInBoth:s})=>s)){n=n.filter(({isInBoth:p})=>!p);let s=!1;for(let p of t.web)p.isInBoth&&(v("Should rerank",p.url,p.originalResult.pos,"=>",p.pos),n.splice(p.pos,0,p.originalResult),s=!0);s&&a.push("rerank")}for(let{isInBoth:s,originalResult:p,description:o}of t.web){let h=!1;s&&(p.normalizedUrl.hostname.endsWith(".amazon.com")||p.normalizedUrl.hostname.endsWith(".twitter.com")||p.normalizedUrl.hostname.endsWith(".starbucks.com")||p.normalizedUrl.hostname.endsWith(".instagram.com")||p.normalizedUrl.hostname.endsWith(".facebook.com"))&&(v("Override description with backup",o),p.description=o,p.node.querySelector("p.snippet-description").innerHTML=Ie(o),h=!0),h&&a.push("snippets")}if(n.length<3)return v("Not enough Brave results, replace!"),a.push("replace"),[a,t.web];if(v(`Found ${l} results in common`),l>=3)return v("Many common results, ignore!",l),a.push("ignore"),[a,n];if(l<=1)return v("Probably bad results, replace!",l),a.push("replace"),[a,t.web];if(n[0].ls)return v("Low confidence, replace!",n[0]),a.push("replace"),[a,t.web];v("Start mixing!"),a.push("mix");for(let s of t.web)if(s.isInBoth||(v("Prepend backup result",s.normalizedUrl.href),r.push(s)),r.length>3)break;return r.push(...n),[a,r]}function vr(n,t){t&&(n.includes("replace")||n.includes("mix"))&&(v("Fallback popup should not be shown anymore after mixing."),document.contains(t)&&(v("Removing fallback popup from DOM"),t.parentNode.removeChild(t)),t=null)}function rn(){return window.document.getElementById("infobox")||window.document.getElementById("codebox")}function on(){return window.document.getElementById("faq")}function an(){return window.document.getElementById("qanda")}function yr(){return window.document.getElementById("pagination")}function br(n,t,r,a){v("Updating DOM with mixed results",n.length,n);let l=window.document.querySelector("#search-elsewhere"),s,p,o,h=yr();if(o=an(),o){v("Found qanda",o);let m=o.querySelector("a[href]")?.href;m&&!n.find(({normalizedUrl:S,url:w})=>w.href===m||S.href===m)&&(v("Drop qanda because not found in mixed results"),o.parentElement.removeChild(o),o=null)}if(!t.includes("ignore")){if(s=rn(),s){v("Found infobox",s);let m=s.querySelector('a[class="infobox-title"')?.href;m&&!n.find(({normalizedUrl:S,url:w})=>w.href===m||S.href===m)&&(v("Drop infobox because not found in mixed results"),s.parentElement.removeChild(s))}p=on(),p&&(v("Found FAQ",p),[...p.querySelectorAll("a[href]")].every(S=>!!n.find(({url:w,normalizedUrl:L})=>w.href===S||L===S))||(v("Drop FAQ because not all URLs are part of mixed results"),p.parentElement.removeChild(p)))}let y=[];for(let m of["rh-package-tracker","rh-calculator","rh-currency","rh-unit-conversion","rh-timezones"]){let S=window.document.getElementById(m);S&&y.push(S)}let A=window.document.querySelector("#results"),T=A?.querySelectorAll("style")||[];if(v("Clearing existing results..."),A.innerHTML="",v("Cleared existing results!"),A.append(...T),(t.includes("replace")||t.includes("mix"))&&r?.query?.length&&!window.document.getElementById("altered-query")){v("Adding altered query on top of results...");let[{altered:m,original:S}]=r.query;if(m&&S){let w=B(x.div("snippet no-bg"),[B(x.div("altered-query-text text-gray"),[x.span(void 0,"Showing results for "),x.a(`/search?q=${encodeURIComponent(m)}`,void 0,m)])]);w.setAttribute("id","altered-query"),window.document.querySelector("#search-main > div")?.prepend(w)}}o&&(t.includes("ignore")||t.includes("mix")||t.includes("rerank"))&&(v("Keep qanda node"),A.appendChild(o));for(let m of y)v("Keep rich result",m),A.appendChild(m);v("Adding organic results");let O=!1;for(let m=0;m<n.length;m+=1){m===9&&l&&(A.appendChild(l),O=!0);let S=n[m],w=S.node||wr(S);v("Appending new result node",w),A.appendChild(w)}!O&&l&&A.appendChild(l),h&&a&&a>=3&&A.appendChild(h)}function B(n,t){if(t!==void 0&&t.length!==0)for(let r of t)r&&n.append(r);return n}var x={el:function(n,t,r,a){let l=document.createElement(n);return t!==void 0&&(l.className=t),r!==void 0&&(l.textContent=r),a!==void 0&&(l.innerHTML=Ie(a)),l},cite:function(...n){return x.el("cite",...n)},div:function(...n){return x.el("div",...n)},span:function(...n){return x.el("span",...n)},p:function(...n){return x.el("p",...n)},button:function(n="",t,r){let a=x.el("button",`${n} button`,t);return a.addEventListener("click",r),a},img:function(n,t,r){let a=x.el("img",t);if(n&&(a.src=n),r)for(let[l,s]of Object.entries(r))a.setAttribute(l,s);return a},a:function(n,t,...r){let a=x.el("a",t,...r);return a.href=n,De()&&(a.target="_blank"),a.rel="noopener",a}};function wr({normalizedUrl:n,url:t,title:r,description:a,deepLinks:l,cluster:s,favicon:p}){let o=n.hostname;o.startsWith("www.")&&(o=o.slice(4));let h=n.pathname.split("/").filter(T=>T.trim().length!=0).map(T=>decodeURIComponent(T)).join("  \u203A ");h.length!==0&&(h=`\u203A ${h}`);let y=[];if(l&&l.length!==0)for(let{href:T,title:O}of l)y.length!==0&&y.push(x.span("attr-separator","\u2022")),y.push(x.a(T,"deep-link",O));let A=[];if(s&&s.length!==0)for(let{url:T,title:O,description:m}of s)A.push(B(x.div("snippet"),[B(x.a(T,"result-header"),[x.span("snippet-title",O)]),x.p("snippet-description",void 0,m)]));return B(x.div("snippet fdb"),[B(x.a(t,"result-header"),[B(x.span("snippet-title"),[B(x.div("favicon-wrapper"),[x.img(p,"favicon",{alt:"\u{1F310}",loading:"lazy",width:16,height:16})]),r]),B(x.cite("snippet-url"),[x.span("netloc",o),x.span("url-path",h)])]),B(x.div("snippet-content"),[x.p("snippet-description",void 0,a)]),A.length!==0&&B(x.div("result-cluster"),A),y.length!==0&&B(x.div("deep-results-buttons"),y)])}function Er(){let n=0,t=[];v("results from mixer",Le);for(let{type:r,index:a}of Le.mixed.main){if(r==="web"){let{url:l,title:s,description:p,ls:o,tc:h,ft:y,bt:A}=Le[r].results[a];t.push({source:"brave",type:r,url:l,normalizedUrl:l&&nn(l),ls:o,tc:h,ft:y,bt:A,title:s,description:p,node:document.querySelector(`[data-type="${r}"][data-pos="${n}"]`),pos:n})}n+=1}return[t,Le.query.sf]}function Tr(){return new URLSearchParams(window.location.search).getAll("q").join("+")}function Ar(){v("Show results!"),document.querySelector("main").classList.remove("d-invisible"),v("Cls list",document.querySelector("main").classList)}async function Sr(n){if(!Tr()){v("No query in URL. Abort!");return}let r=!1,a;if(!n){let m=document?.getElementById("js-gmix")?.getAttribute("data-sw");if(r=!!m,!r){v("SW did not inject anything. Abort!");return}let S=JSON.parse(decodeURIComponent(m));n=S.body,a=S.browserApiVersion}if(!n){v("Empty body for backup results. Abort!");return}let l=document.getElementById("fallback"),s;try{if(s=Zt(Ie(n,Qt)),!s?.web?.length){v("No backup results. Abort!");return}}catch(m){v("error in parseBackupResultsFromHtml!",m);return}v("Got backup results",s?.web?.length,s);let[p,o]=Er();v("Extracted Brave results",o,p.length,p);let h=p.map(({url:m,title:S,description:w,pos:L,source:ee})=>({url:m,title:S,description:w,pos:L,source:ee})),y,A=[];try{[A,y]=gr(p,s)}catch(m){console.error("Mixing error!",m);return}v(">>>",A);let T=!1;if(o===!1&&p.length!==0)v("No need to mix with backup. Abort!",o,A);else try{try{await hr(y)}catch(m){v("error while attaching favicons!",m)}br(y,A,s,a),v("Done updating DOM!"),vr(A,l),T=!0}catch(m){v("error in updateDOM!",m)}let O=[...y].map(m=>m.originalResult||m).map(({tc:m,ft:S,bt:w})=>({type:"web",tc:m,ft:S,bt:w}));return rn()&&O.push({type:"infobox"}),on()&&O.push({type:"faq"}),an()&&O.push({type:"qanda"}),{sw:r,sf:o,brave:h,backup:s,mix_info:A,beforeInd:Re,afterInd:T?Or(O):Re,mixed:T?O:null}}function _r({sw:n,sf:t,brave:r,backup:a,mix_info:l,beforeInd:s,afterInd:p,mixed:o}){let h=r[0]?.ls,y={web:a.web.map(({url:T,title:O,age:m,originalResult:S,source:w})=>({url:T,title:O,age:m,pos:S?.pos,source:w})),mixed:o};for(let T of["place2","img-p","video-p","videos-p","top-stories"])a[T]!==void 0&&(y[T]=a[T]);let A=new Set(y.web.map(({pos:T})=>T).filter(T=>T!==void 0));for(let{url:T,title:O,pos:m,source:S}of r)A.has(m)||y.web.push({url:T,title:O,pos:m,source:S});return{payload:y,debugUrl:jt({withGeoloc:!1}),version:mr,sw:n,sf:t,score:h,mix_info:l,beforeInd:s,afterInd:p,platform:Kt()?"mobile":"desktop",t:3}}function xr(){let n=new Date;n.setHours(0,0,0,0);let t=1e3*60*60*24;return Math.floor(n.getTime()/t)}var ft="app.indepScore",pt="app.indepScoreDay";function en(n){let r=xr(),a=JSON.parse(localStorage.getItem(ft))||[],l=JSON.parse(localStorage.getItem(pt))||r-1;if(r<l&&(localStorage.removeItem(pt),localStorage.removeItem(ft),l=r-1),r>l){localStorage.setItem(pt,JSON.stringify(r));let s=r-l;for(let o=1;o<s;o+=1)a.push([0,0]);a.push([n,1]),a.length>1e3&&a.splice(0,a.length-1e3);let p=Vt();p.available&&window.dispatchEvent(new CustomEvent("Score",{detail:p.value}))}else{let s=a.length;s==0&&(a.push([0,0]),s+=1);let[p,o]=a[s-1];a[s-1]=[p+n,o+1]}localStorage.setItem(ft,JSON.stringify(a))}function Or(n){let t=()=>[0,0],r=()=>[1,1],l={web:o=>o.tc?[1,1]:o.ft?[.5+(o.bt?.25:0),1]:[o.bt?.25:0,1],faq:r,infobox:r,qanda:r,recipes:r,rich:r,locations:r,predicate_entity:r,news:r,videos:r},s=0,p=0;for(let o of n){let h=o.originalResult||o,y=h.type||"web",A=l[y]||t,[T,O]=A(h);s+=T,p+=O}return Math.round(100*s/Math.max(1,p))/100}async function tn(n){try{v("Independence score (before mixing):",Re);let t=await Sr(n);if(t){let r=document.createElement("div");r.classList.add("no-display"),r.id="indep-p-f",r.setAttribute("data",t.afterInd),document.body.appendChild(r)}Xt()||(t?(en(t.afterInd),v("Independence score (after mixing):",t.afterInd),Yt(_r(t),"gmix")):en(Re))}catch(t){v("error mixing",t)}Ar()}Jt()?window.onFetchedBackupResults=tn:window.addEventListener("DOMContentLoaded",()=>tn(),{once:!0});})();
/*! Bundled license information:

dompurify/dist/purify.js:
  (*! @license DOMPurify 2.4.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.3/LICENSE *)
*/
